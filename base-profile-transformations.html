<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Proposal: QIR Adaptor Tool Specification | QIR Adaptor Tool Developer Documentation</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/qat/assets/css/0.styles.9ffaf24c.css" as="style"><link rel="preload" href="/qat/assets/js/app.b68092dd.js" as="script"><link rel="preload" href="/qat/assets/js/2.f962d3f5.js" as="script"><link rel="preload" href="/qat/assets/js/208.cecd5551.js" as="script"><link rel="prefetch" href="/qat/assets/js/10.79f6f345.js"><link rel="prefetch" href="/qat/assets/js/100.00cf4a55.js"><link rel="prefetch" href="/qat/assets/js/101.1f2ac749.js"><link rel="prefetch" href="/qat/assets/js/102.386b745f.js"><link rel="prefetch" href="/qat/assets/js/103.ad555467.js"><link rel="prefetch" href="/qat/assets/js/104.309a2822.js"><link rel="prefetch" href="/qat/assets/js/105.d3c0b4bb.js"><link rel="prefetch" href="/qat/assets/js/106.6fe572d3.js"><link rel="prefetch" href="/qat/assets/js/107.dfc1b2e4.js"><link rel="prefetch" href="/qat/assets/js/108.0a1a5f3c.js"><link rel="prefetch" href="/qat/assets/js/109.d0f0042f.js"><link rel="prefetch" href="/qat/assets/js/11.8eaab91e.js"><link rel="prefetch" href="/qat/assets/js/110.d825b05d.js"><link rel="prefetch" href="/qat/assets/js/111.fb27174a.js"><link rel="prefetch" href="/qat/assets/js/112.cfd94e1f.js"><link rel="prefetch" href="/qat/assets/js/113.ec3a558c.js"><link rel="prefetch" href="/qat/assets/js/114.3b01af74.js"><link rel="prefetch" href="/qat/assets/js/115.b6f1638a.js"><link rel="prefetch" href="/qat/assets/js/116.017b6d35.js"><link rel="prefetch" href="/qat/assets/js/117.4ce09bfa.js"><link rel="prefetch" href="/qat/assets/js/118.fa8ea80d.js"><link rel="prefetch" href="/qat/assets/js/119.68cf75e2.js"><link rel="prefetch" href="/qat/assets/js/12.bf7fac27.js"><link rel="prefetch" href="/qat/assets/js/120.b31bf0f7.js"><link rel="prefetch" href="/qat/assets/js/121.cf28a9dd.js"><link rel="prefetch" href="/qat/assets/js/122.853e537c.js"><link rel="prefetch" href="/qat/assets/js/123.7504423f.js"><link rel="prefetch" href="/qat/assets/js/124.0dc52a36.js"><link rel="prefetch" href="/qat/assets/js/125.5b4d717c.js"><link rel="prefetch" href="/qat/assets/js/126.14ff3ccb.js"><link rel="prefetch" href="/qat/assets/js/127.9fc1d2a3.js"><link rel="prefetch" href="/qat/assets/js/128.f5222b35.js"><link rel="prefetch" href="/qat/assets/js/129.61284ea9.js"><link rel="prefetch" href="/qat/assets/js/13.e910c946.js"><link rel="prefetch" href="/qat/assets/js/130.37c6489d.js"><link rel="prefetch" href="/qat/assets/js/131.4af8d31c.js"><link rel="prefetch" href="/qat/assets/js/132.c8f728ac.js"><link rel="prefetch" href="/qat/assets/js/133.63492d63.js"><link rel="prefetch" href="/qat/assets/js/134.a17a6f1a.js"><link rel="prefetch" href="/qat/assets/js/135.113e308e.js"><link rel="prefetch" href="/qat/assets/js/136.8e8fcafb.js"><link rel="prefetch" href="/qat/assets/js/137.91184899.js"><link rel="prefetch" href="/qat/assets/js/138.6739f1ca.js"><link rel="prefetch" href="/qat/assets/js/139.2482d67d.js"><link rel="prefetch" href="/qat/assets/js/14.8a5fabad.js"><link rel="prefetch" href="/qat/assets/js/140.f931feed.js"><link rel="prefetch" href="/qat/assets/js/141.d95edc98.js"><link rel="prefetch" href="/qat/assets/js/142.5bb707ab.js"><link rel="prefetch" href="/qat/assets/js/143.fde38654.js"><link rel="prefetch" href="/qat/assets/js/144.837f1042.js"><link rel="prefetch" href="/qat/assets/js/145.9e0b072d.js"><link rel="prefetch" href="/qat/assets/js/146.e2075e72.js"><link rel="prefetch" href="/qat/assets/js/147.08766bf8.js"><link rel="prefetch" href="/qat/assets/js/148.d6368384.js"><link rel="prefetch" href="/qat/assets/js/149.1df3d319.js"><link rel="prefetch" href="/qat/assets/js/15.6ecc4c6c.js"><link rel="prefetch" href="/qat/assets/js/150.f814bebf.js"><link rel="prefetch" href="/qat/assets/js/151.8fe0f7c2.js"><link rel="prefetch" href="/qat/assets/js/152.654d18ae.js"><link rel="prefetch" href="/qat/assets/js/153.815448b8.js"><link rel="prefetch" href="/qat/assets/js/154.743a3fd3.js"><link rel="prefetch" href="/qat/assets/js/155.f7f572dd.js"><link rel="prefetch" href="/qat/assets/js/156.45a85ff7.js"><link rel="prefetch" href="/qat/assets/js/157.99bc47b0.js"><link rel="prefetch" href="/qat/assets/js/158.56107de1.js"><link rel="prefetch" href="/qat/assets/js/159.e40408b6.js"><link rel="prefetch" href="/qat/assets/js/16.eba68a95.js"><link rel="prefetch" href="/qat/assets/js/160.b3f71580.js"><link rel="prefetch" href="/qat/assets/js/161.9a83a49c.js"><link rel="prefetch" href="/qat/assets/js/162.d42e86db.js"><link rel="prefetch" href="/qat/assets/js/163.952b8445.js"><link rel="prefetch" href="/qat/assets/js/164.074a8259.js"><link rel="prefetch" href="/qat/assets/js/165.7ece4d9a.js"><link rel="prefetch" href="/qat/assets/js/166.6aba75d0.js"><link rel="prefetch" href="/qat/assets/js/167.92b90516.js"><link rel="prefetch" href="/qat/assets/js/168.69bc7de0.js"><link rel="prefetch" href="/qat/assets/js/169.a4a47c08.js"><link rel="prefetch" href="/qat/assets/js/17.31182c6f.js"><link rel="prefetch" href="/qat/assets/js/170.7acbcbaa.js"><link rel="prefetch" href="/qat/assets/js/171.43bc3449.js"><link rel="prefetch" href="/qat/assets/js/172.2957fd55.js"><link rel="prefetch" href="/qat/assets/js/173.1ace715f.js"><link rel="prefetch" href="/qat/assets/js/174.6ab810b2.js"><link rel="prefetch" href="/qat/assets/js/175.4ce33822.js"><link rel="prefetch" href="/qat/assets/js/176.0c450473.js"><link rel="prefetch" href="/qat/assets/js/177.8e2e29c7.js"><link rel="prefetch" href="/qat/assets/js/178.b08eb93b.js"><link rel="prefetch" href="/qat/assets/js/179.b5637a16.js"><link rel="prefetch" href="/qat/assets/js/18.f1388991.js"><link rel="prefetch" href="/qat/assets/js/180.3ae572bb.js"><link rel="prefetch" href="/qat/assets/js/181.53f9949e.js"><link rel="prefetch" href="/qat/assets/js/182.cac69230.js"><link rel="prefetch" href="/qat/assets/js/183.1cbcb355.js"><link rel="prefetch" href="/qat/assets/js/184.76beb9a6.js"><link rel="prefetch" href="/qat/assets/js/185.02646b69.js"><link rel="prefetch" href="/qat/assets/js/186.55d32a81.js"><link rel="prefetch" href="/qat/assets/js/187.64688d1a.js"><link rel="prefetch" href="/qat/assets/js/188.7052063f.js"><link rel="prefetch" href="/qat/assets/js/189.03e8e441.js"><link rel="prefetch" href="/qat/assets/js/19.01c7ce65.js"><link rel="prefetch" href="/qat/assets/js/190.4457dbef.js"><link rel="prefetch" href="/qat/assets/js/191.3986ec55.js"><link rel="prefetch" href="/qat/assets/js/192.d0987dc5.js"><link rel="prefetch" href="/qat/assets/js/193.7a7bfbfa.js"><link rel="prefetch" href="/qat/assets/js/194.3269b76b.js"><link rel="prefetch" href="/qat/assets/js/195.94d2c0ab.js"><link rel="prefetch" href="/qat/assets/js/196.728c6be5.js"><link rel="prefetch" href="/qat/assets/js/197.27a4e7c4.js"><link rel="prefetch" href="/qat/assets/js/198.fa547510.js"><link rel="prefetch" href="/qat/assets/js/199.e2b73c68.js"><link rel="prefetch" href="/qat/assets/js/20.d690003b.js"><link rel="prefetch" href="/qat/assets/js/200.861754ec.js"><link rel="prefetch" href="/qat/assets/js/201.6a7200a9.js"><link rel="prefetch" href="/qat/assets/js/202.b0644f68.js"><link rel="prefetch" href="/qat/assets/js/203.09f5afff.js"><link rel="prefetch" href="/qat/assets/js/204.238a5df0.js"><link rel="prefetch" href="/qat/assets/js/205.bbea83aa.js"><link rel="prefetch" href="/qat/assets/js/206.c4ec5328.js"><link rel="prefetch" href="/qat/assets/js/207.89ac6dfa.js"><link rel="prefetch" href="/qat/assets/js/209.62755d5a.js"><link rel="prefetch" href="/qat/assets/js/21.a3009e53.js"><link rel="prefetch" href="/qat/assets/js/22.f332834b.js"><link rel="prefetch" href="/qat/assets/js/23.74a46d99.js"><link rel="prefetch" href="/qat/assets/js/24.885a0e52.js"><link rel="prefetch" href="/qat/assets/js/25.604c1383.js"><link rel="prefetch" href="/qat/assets/js/26.27117dd2.js"><link rel="prefetch" href="/qat/assets/js/27.16086f4a.js"><link rel="prefetch" href="/qat/assets/js/28.8055fc14.js"><link rel="prefetch" href="/qat/assets/js/29.48c5ce64.js"><link rel="prefetch" href="/qat/assets/js/3.03284f30.js"><link rel="prefetch" href="/qat/assets/js/30.7dfbc320.js"><link rel="prefetch" href="/qat/assets/js/31.f6df4595.js"><link rel="prefetch" href="/qat/assets/js/32.8b625aa1.js"><link rel="prefetch" href="/qat/assets/js/33.a9410352.js"><link rel="prefetch" href="/qat/assets/js/34.bc15898f.js"><link rel="prefetch" href="/qat/assets/js/35.f2ff71ba.js"><link rel="prefetch" href="/qat/assets/js/36.a55bdbd7.js"><link rel="prefetch" href="/qat/assets/js/37.30343722.js"><link rel="prefetch" href="/qat/assets/js/38.8fd06fdd.js"><link rel="prefetch" href="/qat/assets/js/39.4f588994.js"><link rel="prefetch" href="/qat/assets/js/4.83fce895.js"><link rel="prefetch" href="/qat/assets/js/40.3f6846a5.js"><link rel="prefetch" href="/qat/assets/js/41.e4e888b3.js"><link rel="prefetch" href="/qat/assets/js/42.84022095.js"><link rel="prefetch" href="/qat/assets/js/43.805a3c8a.js"><link rel="prefetch" href="/qat/assets/js/44.ec3bc548.js"><link rel="prefetch" href="/qat/assets/js/45.93230928.js"><link rel="prefetch" href="/qat/assets/js/46.98870ff0.js"><link rel="prefetch" href="/qat/assets/js/47.88e35f0d.js"><link rel="prefetch" href="/qat/assets/js/48.73eece74.js"><link rel="prefetch" href="/qat/assets/js/49.6203caae.js"><link rel="prefetch" href="/qat/assets/js/5.33a173f2.js"><link rel="prefetch" href="/qat/assets/js/50.55d511b6.js"><link rel="prefetch" href="/qat/assets/js/51.dd71d632.js"><link rel="prefetch" href="/qat/assets/js/52.f19e26df.js"><link rel="prefetch" href="/qat/assets/js/53.443d05e1.js"><link rel="prefetch" href="/qat/assets/js/54.d7ad1c3e.js"><link rel="prefetch" href="/qat/assets/js/55.a9b07576.js"><link rel="prefetch" href="/qat/assets/js/56.7f5c85af.js"><link rel="prefetch" href="/qat/assets/js/57.19ba8888.js"><link rel="prefetch" href="/qat/assets/js/58.6e9ee4bc.js"><link rel="prefetch" href="/qat/assets/js/59.79b71128.js"><link rel="prefetch" href="/qat/assets/js/6.7a505dc8.js"><link rel="prefetch" href="/qat/assets/js/60.dc093b25.js"><link rel="prefetch" href="/qat/assets/js/61.32f169d5.js"><link rel="prefetch" href="/qat/assets/js/62.3b48e42a.js"><link rel="prefetch" href="/qat/assets/js/63.80867ba0.js"><link rel="prefetch" href="/qat/assets/js/64.988e3c0b.js"><link rel="prefetch" href="/qat/assets/js/65.d6290739.js"><link rel="prefetch" href="/qat/assets/js/66.62cf9238.js"><link rel="prefetch" href="/qat/assets/js/67.4bc10505.js"><link rel="prefetch" href="/qat/assets/js/68.837b0f2f.js"><link rel="prefetch" href="/qat/assets/js/69.75af18c3.js"><link rel="prefetch" href="/qat/assets/js/7.14b60190.js"><link rel="prefetch" href="/qat/assets/js/70.29be35c4.js"><link rel="prefetch" href="/qat/assets/js/71.c93caf7a.js"><link rel="prefetch" href="/qat/assets/js/72.6200cf6c.js"><link rel="prefetch" href="/qat/assets/js/73.c9b06ab9.js"><link rel="prefetch" href="/qat/assets/js/74.9749e858.js"><link rel="prefetch" href="/qat/assets/js/75.cf61d70d.js"><link rel="prefetch" href="/qat/assets/js/76.684ec402.js"><link rel="prefetch" href="/qat/assets/js/77.9ef7690b.js"><link rel="prefetch" href="/qat/assets/js/78.ef441041.js"><link rel="prefetch" href="/qat/assets/js/79.029ea055.js"><link rel="prefetch" href="/qat/assets/js/8.16f6f26a.js"><link rel="prefetch" href="/qat/assets/js/80.ac2fbf22.js"><link rel="prefetch" href="/qat/assets/js/81.a21175cb.js"><link rel="prefetch" href="/qat/assets/js/82.4b283879.js"><link rel="prefetch" href="/qat/assets/js/83.b96442d2.js"><link rel="prefetch" href="/qat/assets/js/84.deb5a57d.js"><link rel="prefetch" href="/qat/assets/js/85.08925f09.js"><link rel="prefetch" href="/qat/assets/js/86.f9911232.js"><link rel="prefetch" href="/qat/assets/js/87.89533820.js"><link rel="prefetch" href="/qat/assets/js/88.c89e9e4d.js"><link rel="prefetch" href="/qat/assets/js/89.e52d93d9.js"><link rel="prefetch" href="/qat/assets/js/9.35501b87.js"><link rel="prefetch" href="/qat/assets/js/90.4db4f0ca.js"><link rel="prefetch" href="/qat/assets/js/91.3ea77a2a.js"><link rel="prefetch" href="/qat/assets/js/92.ad77cefc.js"><link rel="prefetch" href="/qat/assets/js/93.d8dfd8f3.js"><link rel="prefetch" href="/qat/assets/js/94.1247eb15.js"><link rel="prefetch" href="/qat/assets/js/95.52ae3fc2.js"><link rel="prefetch" href="/qat/assets/js/96.63c104f4.js"><link rel="prefetch" href="/qat/assets/js/97.be172ea0.js"><link rel="prefetch" href="/qat/assets/js/98.c41f4b08.js"><link rel="prefetch" href="/qat/assets/js/99.ad880a22.js">
    <link rel="stylesheet" href="/qat/assets/css/0.styles.9ffaf24c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qat/" class="home-link router-link-active"><!----> <span class="site-name">QIR Adaptor Tool Developer Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/qat/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/qat/Classes/" class="nav-link">
  Classes
</a></div><div class="nav-item"><a href="/qat/Namespaces/" class="nav-link">
  Namespaces
</a></div><div class="nav-item"><a href="/qat/Modules/" class="nav-link">
  Modules
</a></div><div class="nav-item"><a href="/qat/Files/" class="nav-link">
  Files
</a></div><div class="nav-item"><a href="/qat/Pages/" class="nav-link">
  Pages
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/qat/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/qat/Classes/" class="nav-link">
  Classes
</a></div><div class="nav-item"><a href="/qat/Namespaces/" class="nav-link">
  Namespaces
</a></div><div class="nav-item"><a href="/qat/Modules/" class="nav-link">
  Modules
</a></div><div class="nav-item"><a href="/qat/Files/" class="nav-link">
  Files
</a></div><div class="nav-item"><a href="/qat/Pages/" class="nav-link">
  Pages
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="proposal-qir-adaptor-tool-specification"><a href="#proposal-qir-adaptor-tool-specification" class="header-anchor">#</a> Proposal: QIR Adaptor Tool Specification</h1> <p>This document discusses a tool that transforms QIR into a restricted version of the QIR (known as a profile).
We aim to make a specification for a generic tool that allows the user to:</p> <ol><li>Create or use an existing profile without the need of writing code.</li> <li>Validate that a QIR is compliant with the specific profile.</li> <li>Generate a profile compliant QIR from a generic unconstrained QIR (if possible).</li></ol> <p>This document sets out to motivate and demonstrate feasibility of building such a tool.</p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>It is anticipated that most usages of the QIR specification will need to only use a subset of it. These subsets
may further be subject to constraints such as how one allocates or acquire a qubit handle. We refer to such a subset with
constraints as a profile. For instance, it is likely that early versions of quantum hardware will have a limited
set of classical instructions available. With this in mind, the vendor or user of said hardware would define a profile
that only contains a specified subset. One example of such a profile is the base profile,
which only allows function calls and branching, but no arithmetic, classical memory, or classical registers.</p> <p>The generation of QIR according to the spec with no constraints would typically be performed by the frontend. A couple
of examples are Q# or OpenQASM 2.0/3.0. However, for the generated QIR to be practical it is necessary to reduce it using a profile
which is compatible with the target platform:</p> <div class="language-text extra-class"><pre class="language-text"><code>┌──────────────────────┐
│                      │
│       Frontend       │
│                      │
└──────────────────────┘
           │
           │
           ▼
┌──────────────────────┐
│                      │
│         QIR          │
│                      │
└──────────────────────┘
           │
   QIR Adaptor Tool
           │
           ▼
┌──────────────────────┐
│                      │
│    Restricted QIR    │
│                      │
└──────────────────────┘
</code></pre></div><p>We propose that such a reduction could be done using the LLVM passes infrastructure to compose a profile
which would map the QIR to a subset of the available instructions with any required constraints.</p> <h2 id="feasibility-study"><a href="#feasibility-study" class="header-anchor">#</a> Feasibility Study</h2> <p>In order to demonstrate feasibility of this proposal, we have built a proof-of-concept prototype based on LLVM passes which allows transformation from a generic QIR into one which does not have support for dynamic qubit allocation.</p> <p>This transformation is considered to be the smallest, non-trivial case of QIR transformation we can perform which demonstrates the feasibility of this proposal.</p> <p>To demonstrate the feasibility of this proposal, we use Q# as a frontend and will attempt to map the following code</p> <div class="language- extra-class"><pre class="language-text"><code>namespace Feasibility {
    open Microsoft.Quantum.Intrinsic;

    @EntryPoint()
    operation Run() : Unit {
        use qs = Qubit[3];
        for q in 8..10 {
            X(qs[q - 8]);
        }
    }
}
</code></pre></div><p>to the base profile. We will do so using a combination of existing LLVM passes and custom written passes which are specific to the QIR. The above code is interesting as it is not base profile compliant with regards to two aspects: 1) Qubit allocation is not allowed and 2) arithmetic operations are not supported. Using the Q# QIR generator, the <code>Run</code> functions body becomes:</p> <div class="language- extra-class"><pre class="language-text"><code>define internal void @Feasibility__Run__body() {
entry:
  %qs = call %Array* @__quantum__rt__qubit_allocate_array(i64 3)
  call void @__quantum__rt__array_update_alias_count(%Array* %qs, i32 1)
  br label %header__1

header__1:                                        ; preds = %exiting__1, %entry
  %q = phi i64 [ 8, %entry ], [ %4, %exiting__1 ]
  %0 = icmp sle i64 %q, 10
  br i1 %0, label %body__1, label %exit__1

body__1:                                          ; preds = %header__1
  %1 = sub i64 %q, 8
  %2 = call i8* @__quantum__rt__array_get_element_ptr_1d(%Array* %qs, i64 %1)
  %3 = bitcast i8* %2 to %Qubit**
  %qubit = load %Qubit*, %Qubit** %3, align 8
  call void @__quantum__qis__x__body(%Qubit* %qubit)
  br label %exiting__1

exiting__1:                                       ; preds = %body__1
  %4 = add i64 %q, 1
  br label %header__1

exit__1:                                          ; preds = %header__1
  call void @__quantum__rt__array_update_alias_count(%Array* %qs, i32 -1)
  call void @__quantum__rt__qubit_release_array(%Array* %qs)
  ret void
}
</code></pre></div><p>After applying the our demo profile transformation, the QIR is reduced to:</p> <div class="language- extra-class"><pre class="language-text"><code>define void @Feasibility__Run__Interop() local_unnamed_addr #0 {
entry:
  call void @__quantum__qis__x__body(%Qubit* null)
  call void @__quantum__qis__x__body(%Qubit* nonnull inttoptr (i64 1 to %Qubit*))
  call void @__quantum__qis__x__body(%Qubit* nonnull inttoptr (i64 2 to %Qubit*))
  ret void
}
</code></pre></div><p>We note that we successfully have eliminated loops, arithmetic operations, dynamic qubit allocation and alias counting - all operations which are not supported by the base profile.</p> <h2 id="goal"><a href="#goal" class="header-anchor">#</a> Goal</h2> <p>We envision the tool to work as a stand-alone command line tool which can either validate or generate a QIR in accordance with a given profile. To validate, one would run:</p> <div class="language-language extra-class"><pre class="language-text"><code>qat -p profile.yaml --validate unvalidated-qir.ll
</code></pre></div><p>In a similar fashion, generation is performed by adding <code>--generate</code> to the command line:</p> <div class="language-language extra-class"><pre class="language-text"><code>qat -p profile.yaml --generate qir.ll &gt; qir-profile.ll
</code></pre></div><p>Default behaviour of the tool is that it always validates the generated profile. This behaviour can be disabled by</p> <div class="language-language extra-class"><pre class="language-text"><code>qat -p profile.yaml --generate --no-validate qir.ll &gt; qir-profile.ll
</code></pre></div><h1 id="profile-specification"><a href="#profile-specification" class="header-anchor">#</a> Profile Specification</h1> <p>Every profile is specified through a YAML file which defines an object at the top-level. This object must contain the fields <code>name</code> and <code>displayName</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> profile<span class="token punctuation">-</span>name
<span class="token key atrule">displayName</span><span class="token punctuation">:</span> Profile Name
<span class="token comment"># ...</span>
</code></pre></div><p>Additionally, top level also contains the fields <code>version</code> and <code>mode</code>. The version refers to the QIR version which forms the basis for the specification and <code>mode</code> explains how the profile is defined.
The final two top level fields are lists named <code>specification</code> and <code>generation</code>. These contains the specification and generation procedure, respectively.</p> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <p>The default <code>mode</code> of specification is by <code>feature</code> which means that specification describes the feature set available. Alternatively, one can specify a profile by <code>limitation</code>. As an example profile for</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> profile<span class="token punctuation">-</span>name
<span class="token key atrule">displayName</span><span class="token punctuation">:</span> Profile Name
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">1.0</span>
<span class="token key atrule">mode</span><span class="token punctuation">:</span> feature
<span class="token key atrule">specification</span><span class="token punctuation">:</span>
  <span class="token key atrule">functions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> __quantum__qis__toffoli__body
    <span class="token punctuation">-</span> __quantum__qis__cnot__body
    <span class="token punctuation">-</span> __quantum__qis__cz__body
    <span class="token punctuation">-</span> __quantum__qis__h__body
    <span class="token punctuation">-</span> __quantum__qis__mz__body
    <span class="token punctuation">-</span> __quantum__qis__reset__body
    <span class="token punctuation">-</span> __quantum__qis__rx__body
    <span class="token punctuation">-</span> __quantum__qis__ry__body
    <span class="token punctuation">-</span> __quantum__qis__rz__body
    <span class="token punctuation">-</span> __quantum__qis__s__body
    <span class="token punctuation">-</span> __quantum__qis__s__adj
    <span class="token punctuation">-</span> __quantum__qis__t__body
    <span class="token punctuation">-</span> __quantum__qis__t__adj
    <span class="token punctuation">-</span> __quantum__qis__x__body
    <span class="token punctuation">-</span> __quantum__qis__y__body
    <span class="token punctuation">-</span> __quantum__qis__z__body
  <span class="token key atrule">instructions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> call
    <span class="token punctuation">-</span> br
    <span class="token punctuation">-</span> ret
    <span class="token punctuation">-</span> inttoptr
<span class="token comment"># ...</span>
</code></pre></div><p>This specification describes that 16 quantum instructions are available and 4 classical operations of the full QIR spec. Contrary, a specification by <code>limitation</code> could be as follows:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> profile<span class="token punctuation">-</span>name
<span class="token key atrule">displayName</span><span class="token punctuation">:</span> Profile Name
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">1.0</span>
<span class="token key atrule">mode</span><span class="token punctuation">:</span> limitation
<span class="token key atrule">specification</span><span class="token punctuation">:</span>
  <span class="token key atrule">functions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> __quantum__rt__array_update_alias_count
    <span class="token punctuation">-</span> __quantum__rt__array_update_reference_count
  <span class="token key atrule">instructions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> br
<span class="token comment"># ...</span>
</code></pre></div><p>This profile specifies a system that does not allow reference and alias counting and neither have support for branching, but otherwise has the full QIR vesion 1.0 available.</p> <h2 id="generation-specification"><a href="#generation-specification" class="header-anchor">#</a> Generation specification</h2> <p>To achieve the QIR generation in the feasibility section we made use of a number of different passes in order fold constants, unroll loops and map qubit allocations to static allocations. Based on this, we propose that generators are specified by creating a pipeline of LLVM passes to analyse and transform the QIR:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> profile<span class="token punctuation">-</span>name
<span class="token key atrule">displayName</span><span class="token punctuation">:</span> Profile Name
<span class="token comment"># ...</span>
<span class="token key atrule">generation</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">passName</span><span class="token punctuation">:</span> loopUnroll
  <span class="token punctuation">-</span> <span class="token key atrule">passName</span><span class="token punctuation">:</span> functionInline
  <span class="token punctuation">-</span> <span class="token key atrule">passName</span><span class="token punctuation">:</span> useStaticQubitAllocation
  <span class="token punctuation">-</span> <span class="token key atrule">passName</span><span class="token punctuation">:</span> eliminateClassicalMemoryUsage
  <span class="token punctuation">-</span> <span class="token key atrule">passName</span><span class="token punctuation">:</span> ignoreCall
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">names</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> __quantum__rt__array_update_alias_count
        <span class="token punctuation">-</span> __quantum__rt__array_update_reference_count
</code></pre></div><p>For those passes which are defined specifically for QIR we we allow configuration to be passed to them. This will allow the end-user to fine-tune the behaviour of profile generator.</p> <h1 id="library-outline"><a href="#library-outline" class="header-anchor">#</a> Library outline</h1> <p>This is a placeholder for describing the outline of the QAT library. The aim is to create a dynamic library where we can add new components that allow to extend the QIR profile generation components with more passes and/or spefication options.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/qat/assets/js/app.b68092dd.js" defer></script><script src="/qat/assets/js/2.f962d3f5.js" defer></script><script src="/qat/assets/js/208.cecd5551.js" defer></script>
  </body>
</html>
